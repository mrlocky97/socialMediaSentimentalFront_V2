<div class="analytics-container">
  <!-- Header -->
  <div class="header">
    <button mat-icon-button (click)="goBack()" class="back-button">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h1>Campaign Analytics</h1>
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
  <div class="loading-container">
    <mat-spinner></mat-spinner>
  </div>
  }

  <!-- Campaign Info -->
  @if (currentCampaign()) {
  <div class="campaign-info">
    <h2>{{ currentCampaign()!.name }}</h2>
    <p>{{ currentCampaign()!.description }}</p>
  </div>

  <!-- Analytics Content -->
  <mat-tab-group class="analytics-tabs">
    <mat-tab label="Overview">
      <div class="tab-content">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Campaign Metrics</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="metrics-grid">
              <div class="metric-card">
                <div class="metric-value">{{ currentCampaign()!.maxTweets | number }}</div>
                <div class="metric-label">Max Tweets</div>
              </div>
              <div class="metric-card">
                <div class="metric-value">{{ currentCampaign()!.hashtags.length }}</div>
                <div class="metric-label">Hashtags</div>
              </div>
              <div class="metric-card">
                <div class="metric-value">{{ currentCampaign()!.keywords.length }}</div>
                <div class="metric-label">Keywords</div>
              </div>
              <div class="metric-card">
                <div class="metric-value">{{ getStatusText(currentCampaign()!.status) }}</div>
                <div class="metric-label">Status</div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>

    <mat-tab label="Configuration">
      <div class="tab-content">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Campaign Configuration</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="config-section">
              <h3>Tracking Parameters</h3>
              <p><strong>Type:</strong> {{ getTypeText(currentCampaign()!.type) }}</p>
              <p>
                <strong>Sentiment Analysis:</strong>
                {{ currentCampaign()!.sentimentAnalysis ? 'Enabled' : 'Disabled' }}
              </p>

              @if (currentCampaign()!.hashtags.length > 0) {
              <div class="parameter-section">
                <h4>Hashtags</h4>
                <div class="tags-container">
                  @for (hashtag of currentCampaign()!.hashtags; track hashtag) {
                  <span class="tag">#{{ hashtag }}</span>
                  }
                </div>
              </div>
              } @if (currentCampaign()!.keywords.length > 0) {
              <div class="parameter-section">
                <h4>Keywords</h4>
                <div class="tags-container">
                  @for (keyword of currentCampaign()!.keywords; track keyword) {
                  <span class="tag">{{ keyword }}</span>
                  }
                </div>
              </div>
              } @if (currentCampaign()!.mentions.length > 0) {
              <div class="parameter-section">
                <h4>Mentions</h4>
                <div class="tags-container">
                  @for (mention of currentCampaign()!.mentions; track mention) {
                  <span class="tag">{{ mention }}</span>
                  }
                </div>
              </div>
              }
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>

    <mat-tab label="Timeline">
      <div class="tab-content">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Campaign Timeline</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="timeline-info">
              <p>
                <strong>Start Date:</strong> {{ currentCampaign()!.startDate | date : 'fullDate' }}
              </p>
              <p><strong>End Date:</strong> {{ currentCampaign()!.endDate | date : 'fullDate' }}</p>
              <p><strong>Status:</strong> {{ currentCampaign()!.status | titlecase }}</p>
              <p><strong>Created:</strong> {{ currentCampaign()!.createdAt | date : 'medium' }}</p>
              <p>
                <strong>Last Updated:</strong> {{ currentCampaign()!.updatedAt | date : 'medium' }}
              </p>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>
  </mat-tab-group>
  } @else {
  <div class="error-container">
    <mat-icon>error</mat-icon>
    <h3>Campaign not found</h3>
    <p>The requested campaign could not be loaded.</p>
    <button mat-raised-button color="primary" (click)="goBack()">Go Back</button>
  </div>
  }
</div>
